(window.webpackJsonp=window.webpackJsonp||[]).push([[417],{134:function(t,e,n){t.exports=n(412)},16:function(t,e,n){t.exports=n(684)},2:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},2059:function(t,e,n){"use strict";n.r(e);var a=n(46),s=n.n(a),r=n(94),o=n.n(r),i=n(81),c=n.n(i),u=n(95),l=n.n(u),f=n(134),d=n.n(f),p=n(122),m=n.n(p),g=n(406),v=n.n(g),h=n(40),k=n.n(h),x=n(16),_=n.n(x),b=n(235),w=n.n(b),y=n(2069),S=n(2130),R=n(440),I=n.n(R);function T(t,e){var n=s()(t);if(o.a){var a=o()(t);e&&(a=a.filter((function(e){return c()(t,e).enumerable}))),n.push.apply(n,a)}return n}var L=[{title:"课时",dataIndex:"lesson",scopedSlots:{customRender:"lesson"}},{title:"作业/考试",dataIndex:"name",scopedSlots:{customRender:"name"},filters:[{text:"作业",value:"homework"},{text:"考试",value:"testpaper"}]},{title:"题量",dataIndex:"item_count",scopedSlots:{customRender:"item_count"}},{title:"已批",dataIndex:"finished",scopedSlots:{customRender:"finished"}},{title:"未批",dataIndex:"reviewing",scopedSlots:{customRender:"reviewing"}},{title:"未交",dataIndex:"doing",scopedSlots:{customRender:"doing"}},{title:"开始时间",dataIndex:"startTime",scopedSlots:{customRender:"startTime"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],O=[{title:"姓名",dataIndex:"nickname",scopedSlots:{customRender:"nickname"}},{title:"成绩",dataIndex:"grade",scopedSlots:{customRender:"grade"}},{title:"提交时间",dataIndex:"end_time",scopedSlots:{customRender:"end_time"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"批阅人",dataIndex:"teacherInfo",scopedSlots:{customRender:"teacherInfo"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],P={all:{total:0,offset:0,pageSize:5},reviewing:{total:0,offset:0,pageSize:5},doing:{total:0,offset:0,pageSize:5},finished:{total:0,offset:0,pageSize:5}},M={name:"HomeWorkReview",components:{ClassName:S.a},data:function(){return{columns:L,resultColumns:O,getListLoading:!1,homeworksList:[],examResultList:{},paging:{total:0,offset:0,pageSize:10},examPaging:P,modalVisible:!1,currentTab:0,currentTask:{},status:["all","reviewing","doing","finished"],statusMap:{doing:"进行中",paused:"暂停",reviewing:"未批阅",finished:"已批阅"},gradeMap:{excellent:"优秀",good:"良好",passed:"合格",unpassed:"不合格"}}},watch:{currentTab:function(t){this.getExamResults(t)}},computed:{examResults:function(){var t=this.status[this.currentTab];return this.examResultList[t]}},created:function(){this.getHomeworkList()},methods:{handleExamTableChange:function(t){var e=this.status[this.currentTab],n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){k()(t,e,n[e])})):l.a?d()(t,l()(n)):T(Object(n)).forEach((function(e){m()(t,e,c()(n,e))}))}return t}({},this.examPaging[e]);n.current=t.current,n.offset=(t.current-1)*t.pageSize,this.examPaging[e]=n;var a={limit:t.pageSize,offset:(t.current-1)*t.pageSize};this.getExamResults(this.currentTab,a)},getHomeworkList:function(){var t=arguments,e=this;return v()(w.a.mark((function n(){var a,s,r,o;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:{},e.getListLoading=!0,n.prev=2,n.next=5,y.v.getExams({multiClassId:e.$route.params.id,types:a.types||[],offset:a.offset||0,limit:a.pageSize||10});case 5:s=n.sent,r=s.data,o=s.paging,e.homeworksList=r,e.paging=I.a.assign(o,{pageSize:Number(o.limit)});case 10:return n.prev=10,e.getListLoading=!1,n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[2,,10,13]])})))()},showResultListModal:function(t,e){var n=this.status.indexOf(t);this.currentTask=e,this.currentTab=n,this.currentTab==n&&this.getExamResults(n),this.modalVisible=!0},getExamResults:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.status[e];console.log(a),console.log(this.examPaging[a]),y.v.getExamResults({status:a,multiClassId:this.$route.params.id,taskId:this.currentTask.id,offset:n.offset||this.examPaging[a].offset||P[a].offset,limit:n.limit||this.examPaging[a].pageSize||P[a].pageSize}).then((function(e){e.paging.page=e.paging.offset/e.paging.limit+1,t.examPaging[a]=_()(t.examPaging[a],e.paging),t.$set(t.examResultList,a,e)}))},change:function(t,e,n,a){a.currentDataSource;var s={};e&&I.a.isArray(e.name)&&(s.types=e.name),t&&(s.offset=t.pageSize*(t.current-1),s.pageSize=t.pageSize),s&&this.getHomeworkList(s)}}},z=M,C=(n(2327),n(31)),j=Object(C.a)(z,(function(){var t=this,e=t._self._c;return e("div",[e("a-spin",{attrs:{spinning:t.getListLoading}},[e("a-table",{attrs:{columns:t.columns,"data-source":t.homeworksList,pagination:t.paging,rowKey:function(t){return t.id}},on:{change:t.change},scopedSlots:t._u([{key:"lesson",fn:function(t,n){return e("class-name",{attrs:{record:n}})}},{key:"name",fn:function(e,n){return[t._v(t._s(n.tasks.assessment.name))]}},{key:"item_count",fn:function(e,n){return[t._v(t._s(n.tasks.assessment.item_count))]}},{key:"finished",fn:function(n,a){return e("a",{on:{click:function(e){return t.showResultListModal("finished",a.tasks)}}},[t._v("\n        "+t._s(a.tasks.assessmentStatusNum.finished||0)+"\n      ")])}},{key:"reviewing",fn:function(n,a){return e("a",{on:{click:function(e){return t.showResultListModal("reviewing",a.tasks)}}},[t._v("\n        "+t._s(a.tasks.assessmentStatusNum.reviewing||0)+"\n      ")])}},{key:"doing",fn:function(n,a){return e("a",{on:{click:function(e){return t.showResultListModal("doing",a.tasks)}}},[t._v("\n        "+t._s(a.tasks.assessmentStatusNum.doing||0)+"\n      ")])}},{key:"startTime",fn:function(e,n){return[t._v("\n        "+t._s(t.$dateFormat(n.tasks.createdTime,"YYYY-MM-DD HH:mm"))+"\n      ")]}},{key:"action",fn:function(n,a){return[e("a-space",{attrs:{size:"large"}},[e("a",{staticClass:"ant-dropdown-link",attrs:{href:"/course/".concat(a.tasks.courseId,"/manage/exam/activity/").concat(a.tasks.activityId,"/analysis"),target:"_blank"}},[t._v("\n            答题分布\n          ")]),t._v(" "),e("a-button",{attrs:{type:"link","data-target":"#modal","data-toggle":"modal","data-url":"/course/".concat(a.tasks.courseId,"/activity/").concat(a.tasks.activityId,"/testpaper/graph")}},[t._v("\n            成绩分布\n          ")])],1)]}}])})],1),t._v(" "),e("a-modal",{attrs:{visible:t.modalVisible,footer:null,title:t.currentTask.assessment?t.currentTask.assessment.name:"",width:920},on:{cancel:function(e){t.modalVisible=!1}}},[e("a-tabs",{model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[e("a-tab-pane",{key:0,attrs:{tab:"全部"}}),t._v(" "),e("a-tab-pane",{key:1,attrs:{tab:"未批阅"}}),t._v(" "),e("a-tab-pane",{key:2,attrs:{tab:"进行中"}}),t._v(" "),e("a-tab-pane",{key:3,attrs:{tab:"已批阅"}})],1),t._v(" "),t.examResults?e("a-table",{attrs:{columns:t.resultColumns,"data-source":t.examResults.data,pagination:t.examPaging[t.status[t.currentTab]],rowKey:function(t){return t.id}},on:{change:t.handleExamTableChange},scopedSlots:t._u([{key:"nickname",fn:function(e,n){return[t._v(t._s(n.userInfo.nickname))]}},{key:"grade",fn:function(e,n){return[t._v(t._s("reviewing"===n.status?"--":t.gradeMap[n.answerReportInfo.grade]))]}},{key:"teacherInfo",fn:function(e,n){return[t._v(t._s(n.teacherInfo.nickname||"--"))]}},{key:"status",fn:function(n){return["reviewing"==n?e("span",{staticStyle:{color:"#fb8d4d"}},[t._v(t._s(t.statusMap[n]))]):"doing"==n?e("span",{staticStyle:{color:"#43bc60"}},[t._v(t._s(t.statusMap[n]))]):"finished"==n?e("span",{staticStyle:{color:"#999"}},[t._v(t._s(t.statusMap[n]))]):t._e()]}},{key:"end_time",fn:function(e){return[t._v("\n        "+t._s(t.$dateFormat(e,"YYYY-MM-DD HH:mm"))+"\n      ")]}},{key:"action",fn:function(n,a){return["reviewing"===a.status?e("a",{staticClass:"ant-dropdown-link",attrs:{href:"testpaper"===t.currentTask.type?"/course/".concat(t.currentTask.courseId,"/manage/testpaper/").concat(a.id,"/check?action=check"):"/course/".concat(t.currentTask.courseId,"/manage/homework/").concat(a.id,"/check?action=check"),target:"_blank"}},[t._v("去批阅")]):"finished"===a.status?e("a",{staticClass:"ant-dropdown-link",attrs:{href:"/homework/result/".concat(a.id,"/show?action=check"),target:"_blank"}},[t._v("查看结果")]):t._e()]}}],null,!1,3142312363)}):t._e()],1)],1)}),[],!1,null,null,null);e.default=j.exports},2071:function(t,e,n){n(2072),t.exports=n(55).Reflect.deleteProperty},2072:function(t,e,n){var a=n(93),s=n(222).f,r=n(165);a(a.S,"Reflect",{deleteProperty:function(t,e){var n=s(r(t),e);return!(n&&!n.configurable)&&delete t[e]}})},2077:function(t,e,n){t.exports=n(2071)},2130:function(t,e,n){"use strict";var a={name:"ClassName",props:{record:{type:Object,required:!0,default:function(){return{}}}},computed:{className:function(){var t=this.record,e=t.chapterTitle,n=t.unitTitle,a=t.title,s=t.tasks,r=t.tasks.number,o="";if("lesson"===s.mode)o="".concat(r,". ").concat(a);else{var i=r.split("-");o="".concat(r,".").concat(i[1]-1," [任务]").concat(s.title)}return n&&(o="".concat(n," ").concat(o)),e&&(o=n?"".concat(e," - ").concat(o):"".concat(e," ").concat(o)),o}}},s=n(31),r=Object(s.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-overflow"},[e("span",{attrs:{title:t.className}},[t._v(t._s(t.className))]),t._v(" "),e("br"),t._v(" "),"published"!=t.record.tasks.status?e("a-tag",{staticStyle:{"margin-top":"4px"}},[t._v("未发布")]):t._e()],1)}),[],!1,null,null,null);e.a=r.exports},2205:function(t,e,n){},2327:function(t,e,n){"use strict";n(2205)},264:function(t,e,n){n(265);var a=n(55).Object;t.exports=function(t,e){return a.getOwnPropertyDescriptor(t,e)}},265:function(t,e,n){var a=n(166),s=n(222).f;n(407)("getOwnPropertyDescriptor",(function(){return function(t,e){return s(a(t),e)}}))},3:function(t,e,n){var a=n(122);function s(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),a(t,s.key,s)}}t.exports=function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),a(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},40:function(t,e,n){var a=n(122);t.exports=function(t,e,n){return e in t?a(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},408:function(t,e,n){n(482),t.exports=n(55).Object.getOwnPropertySymbols},409:function(t,e,n){n(410),t.exports=n(55).Object.getOwnPropertyDescriptors},410:function(t,e,n){var a=n(93),s=n(411),r=n(166),o=n(222),i=n(483);a(a.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,a=r(t),c=o.f,u=s(a),l={},f=0;u.length>f;)void 0!==(n=c(a,e=u[f++]))&&i(l,e,n);return l}})},411:function(t,e,n){var a=n(443),s=n(414),r=n(165),o=n(123).Reflect;t.exports=o&&o.ownKeys||function(t){var e=a.f(r(t)),n=s.f;return n?e.concat(n(t)):e}},412:function(t,e,n){n(413);var a=n(55).Object;t.exports=function(t,e){return a.defineProperties(t,e)}},413:function(t,e,n){var a=n(93);a(a.S+a.F*!n(176),"Object",{defineProperties:n(481)})},46:function(t,e,n){t.exports=n(911)},81:function(t,e,n){t.exports=n(264)},911:function(t,e,n){n(912),t.exports=n(55).Object.keys},912:function(t,e,n){var a=n(442),s=n(441);n(407)("keys",(function(){return function(t){return s(a(t))}}))},94:function(t,e,n){t.exports=n(408)},95:function(t,e,n){t.exports=n(409)}}]);